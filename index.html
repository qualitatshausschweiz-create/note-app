<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Notizen Premium</title>

<style>
/* ============================================================
   RESET + VARIABILI
   ============================================================ */
:root {
  --accent: #007aff;
  --app-font: system-ui, sans-serif;
  --text-size: 16px;
  --blur-amount: 18px;
}

body {
  margin: 0;
  font-family: var(--app-font);
  font-size: var(--text-size);
  background: #f2f2f7;
  color: #111;
  transition: background 0.3s, color 0.3s;
}

body.dark {
  background: #1c1c1e;
  color: #fff;
}

body.amoled {
  background: #000;
  color: #fff;
}

/* ============================================================
   PIN OVERLAY
   ============================================================ */
#pinOverlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  backdrop-filter: blur(10px);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 99999;
}

#pinBox {
  background: #fff;
  color: #000;
  padding: 25px;
  border-radius: 18px;
  width: 260px;
  text-align: center;
}

#pinTitle {
  font-size: 20px;
  margin-bottom: 15px;
}

#pinCircles {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 20px;
}

.pinCircle {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  border: 2px solid #000;
}

.pinCircle.filled {
  background: #000;
}

#pinPad {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

.pinKey {
  padding: 14px;
  font-size: 18px;
  border-radius: 12px;
  border: none;
  background: #e5e5ea;
}

.pinKey.backspace {
  background: #ff3b30;
  color: #fff;
}

#pinError {
  margin-top: 10px;
  color: red;
  opacity: 0;
  transition: opacity 0.3s;
}

/* ============================================================
   HEADER
   ============================================================ */
header {
  display: flex;
  justify-content: space-between;
  padding: 15px;
  font-size: 20px;
  font-weight: bold;
}

.iconBtn {
  background: none;
  border: none;
  font-size: 22px;
  margin-left: 10px;
}

/* ============================================================
   CATEGORIE
   ============================================================ */
#categories {
  display: flex;
  overflow-x: auto;
  gap: 12px;
  padding: 10px;
}

.cat {
  padding: 8px 14px;
  background: #e5e5ea;
  border-radius: 12px;
  white-space: nowrap;
}

/* ============================================================
   NOTE LIST
   ============================================================ */
#notesList {
  padding: 15px;
}

.noteItem {
  background: #fff;
  padding: 14px;
  margin-bottom: 12px;
  border-radius: 12px;
  border-left: 4px solid var(--accent);
}

/* ============================================================
   ADD NOTE BUTTON
   ============================================================ */
#addNoteBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: none;
  background: var(--accent);
  color: #fff;
  font-size: 32px;
}

/* ============================================================
   EDITOR
   ============================================================ */
#noteEditor {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  backdrop-filter: blur(10px);
  display: none;
  justify-content: center;
  align-items: center;
}

#noteEditorBox {
  background: #fff;
  width: 90%;
  max-width: 400px;
  padding: 20px;
  border-radius: 18px;
}

#noteText {
  width: 100%;
  height: 150px;
  margin-top: 10px;
  padding: 10px;
  border-radius: 12px;
  border: 1px solid #ccc;
}

#editorButtons {
  display: flex;
  justify-content: space-between;
  margin-top: 15px;
}

#paletteSelector {
  margin-top: 10px;
}

.colorDot {
  width: 26px;
  height: 26px;
  border-radius: 50%;
  margin-right: 8px;
  display: inline-block;
  border: 2px solid transparent;
}

.colorDot.selected {
  border-color: #000;
}

/* ============================================================
   POPUP GENERICI
   ============================================================ */
.popupBox {
  background: #fff;
  padding: 20px;
  border-radius: 18px;
  width: 85%;
  max-width: 380px;
}

#archivePopup,
#infoPopup,
#resetPopup {
  position: fixed;
  inset: 0;
  display: none;
  justify-content: center;
  align-items: center;
  background: rgba(0,0,0,0.4);
  backdrop-filter: blur(10px);
}

/* ============================================================
   SETTINGS PANEL
   ============================================================ */
#settingsPanel {
  position: fixed;
  inset: 0;
  display: none;
  justify-content: flex-end;
  background: rgba(0,0,0,0.3);
  backdrop-filter: blur(5px);
}

#settingsSheet {
  width: 80%;
  max-width: 350px;
  background: #fff;
  height: 100%;
  padding: 20px;
  border-radius: 20px 0 0 20px;
  transform: translateX(100%);
  transition: transform 0.3s;
}

#settingsPanel.show #settingsSheet {
  transform: translateX(0);
}

.settingsItem {
  width: 100%;
  padding: 12px;
  margin-bottom: 8px;
  background: #e5e5ea;
  border-radius: 12px;
  border: none;
  text-align: left;
}

.settingsSection {
  margin-top: 20px;
  font-weight: bold;
}

.settingsClose {
  margin-top: 20px;
  width: 100%;
  padding: 12px;
  background: var(--accent);
  color: #fff;
  border-radius: 12px;
  border: none;
}

/* ============================================================
   BANNER
   ============================================================ */
#bannerMsg {
  position: fixed;
  top: 15px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--accent);
  color: #fff;
  padding: 10px 20px;
  border-radius: 12px;
  opacity: 0;
  transition: opacity 0.3s;
}

#bannerMsg.show {
  opacity: 1;
}
</style>
</head>

<body>

<!-- ============================================================
     BOX 2.1 ‚Äî PIN OVERLAY
     ============================================================ -->
<div id="pinOverlay">
  <div id="pinBox">
    <div id="pinTitle">Inserisci PIN</div>

    <div id="pinCircles">
      <div class="pinCircle"></div>
      <div class="pinCircle"></div>
      <div class="pinCircle"></div>
      <div class="pinCircle"></div>
    </div>

    <div id="pinPad">
      <button class="pinKey" data-digit="1">1</button>
      <button class="pinKey" data-digit="2">2</button>
      <button class="pinKey" data-digit="3">3</button>

      <button class="pinKey" data-digit="4">4</button>
      <button class="pinKey" data-digit="5">5</button>
      <button class="pinKey" data-digit="6">6</button>

      <button class="pinKey" data-digit="7">7</button>
      <button class="pinKey" data-digit="8">8</button>
      <button class="pinKey" data-digit="9">9</button>

      <button class="pinKey empty"></button>
      <button class="pinKey" data-digit="0">0</button>
      <button class="pinKey backspace" id="pinBackspace">‚å´</button>
    </div>

    <div id="pinError"></div>
  </div>
</div>

<!-- ============================================================
     BOX 2.2 ‚Äî APP WRAPPER
     ============================================================ -->
<div id="app">

  <div id="bannerMsg"></div>

  <header>
    <div id="appTitle">Notizen</div>
    <div>
      <button id="themeBtn" class="iconBtn">üåô</button>
      <button id="langBtn" class="iconBtn">üåê</button>
      <button id="backupBtn" class="iconBtn">üõü</button>
      <button id="settingsBtn" class="iconBtn">‚öôÔ∏è</button>
    </div>
  </header>

  <div id="categories">
    <div class="cat" data-cat="favorite">Favoriten</div>
    <div class="cat" data-cat="alle">Alle</div>
    <div class="cat" data-cat="arbeit">Arbeit</div>
    <div class="cat" data-cat="einkauf">Einkauf</div>
    <div class="cat" data-cat="zuhause">Zuhause</div>
    <div class="cat" data-cat="ideen">Ideen</div>
    <div class="cat" data-cat="personlich">Pers√∂nlich</div>
  </div>

  <div id="notesList"></div>

  <button id="addNoteBtn">+</button>

</div>

<!-- ============================================================
     BOX 2.3 ‚Äî EDITOR NOTE
     ============================================================ -->
<div id="noteEditor">
  <div id="noteEditorBox">

    <button id="deleteNoteBtn">üóë</button>

    <h2 id="editorTitle">Neue Notiz</h2>

    <textarea id="noteText"></textarea>

    <div id="paletteSelector">
      <span style="font-size:14px; opacity:0.7;">Palette:</span>
      <button class="paletteBtn" data-pal="warm">Caldi</button>
      <button class="paletteBtn" data-pal="cool">Freddi</button>
      <button class="paletteBtn" data-pal="pastel">Pastello</button>
      <button class="paletteBtn" data-pal="mix">Mix</button>
    </div>

    <div id="colorRow"></div>

    <div id="editorButtons">
      <button id="cancelBtn">Abbrechen</button>
      <button id="saveBtn">Speichern</button>
    </div>

  </div>
</div>

<!-- ============================================================
     BOX 2.4 ‚Äî POPUP PREMIUM + SETTINGS PANEL
     ============================================================ -->
<div id="archivePopup">
  <div class="popupBox">
    <h2>Archivio</h2>
    <div id="archiveList"></div>
    <button id="archiveCloseBtn" class="popupBtn">Chiudi</button>
  </div>
</div>

<div id="infoPopup">
  <div class="popupBox">
    <h2>Info App</h2>
    <p>Versione: 2.0 Premium</p>
    <p>Autore: Sandro</p>
    <p>App personalizzata con funzioni premium</p>
    <button id="infoCloseBtn" class="popupBtn">Chiudi</button>
  </div>
</div>

<div id="resetPopup">
  <div class="popupBox">
    <h2>Reset App</h2>
    <p>Questa azione canceller√† tutte le note e le impostazioni.</p>
    <button id="resetConfirmBtn" class="popupBtn">Conferma</button>
    <button id="resetCancelBtn" class="popupBtn">Annulla</button>
  </div>
</div>

<div id="settingsPanel">
  <div id="settingsSheet">

    <div class="settingsTitle">Impostazioni</div>

    <div class="settingsSection">Aspetto</div>
    <button class="settingsItem" id="settingsTheme">Tema (Chiaro/Scuro)</button>
    <button class="settingsItem" id="settingsAmoled">Tema AMOLED</button>
    <button class="settingsItem" id="settingsFont">Font</button>
    <button class="settingsItem" id="settingsTextSize">Dimensione testo</button>
    <button class="settingsItem" id="settingsAccent">Colore interfaccia</button>
    <button class="settingsItem" id="settingsBlur">Blur sfondo</button>

    <div class="settingsSection">Sicurezza</div>
    <button class="settingsItem" id="settingsChangePin">Cambia PIN</button>
    <button class="settingsItem" id="settingsResetPin">Reset PIN</button>
    <button class="settingsItem" id="settingsTimeout">Timeout PIN</button>

    <div class="settingsSection">Note</div>
    <button class="settingsItem" id="settingsArchive">Archivio</button>
    <button class="settingsItem" id="settingsAnimations">Animazioni Premium</button>
    <button class="settingsItem" id="settingsHaptics">Haptic Feedback</button>

    <div class="settingsSection">Sistema</div>
    <button class="settingsItem" id="settingsExport">Esporta</button>
    <button class="settingsItem" id="settingsImport">Importa</button>
    <button class="settingsItem" id="settingsResetApp">Reset App</button>
    <button class="settingsItem" id="settingsInfo">Info App</button>

    <button class="settingsClose">Chiudi</button>

  </div>
</div>

<!-- ============================================================
     SCRIPT COMPLETO
     ============================================================ -->
<script>
/* ============================================================
   STORAGE KEYS
   ============================================================ */
const STORAGE_NOTES_KEY = "notes_v1";
const STORAGE_ARCHIVE_KEY = "archive_v1";
const STORAGE_LANG_KEY = "lang_v1";
const STORAGE_THEME_KEY = "theme_v1";
const STORAGE_AMOLED_KEY = "amoled_v1";
const STORAGE_FONT_KEY = "font_v1";
const STORAGE_TEXTSIZE_KEY = "textsize_v1";
const STORAGE_ACCENT_KEY = "accent_v1";
const STORAGE_BLUR_KEY = "blur_v1";
const STORAGE_PIN_KEY = "pin_v1";
const STORAGE_TIMEOUT_KEY = "timeout_v1";
const STORAGE_ANIM_KEY = "anim_v1";
const STORAGE_HAPTIC_KEY = "haptic_v1";

const DEFAULT_PIN = "4618";

/* ============================================================
   ELEMENTI DOM
   ============================================================ */
const pinOverlay = document.getElementById("pinOverlay");
const pinCircles = Array.from(document.querySelectorAll(".pinCircle"));
const pinKeys = Array.from(document.querySelectorAll(".pinKey"));
const pinBackspace = document.getElementById("pinBackspace");
const pinError = document.getElementById("pinError");

const bannerMsg = document.getElementById("bannerMsg");

const notesList = document.getElementById("notesList");
const addNoteBtn = document.getElementById("addNoteBtn");

const noteEditor = document.getElementById("noteEditor");
const editorTitle = document.getElementById("editorTitle");
const noteText = document.getElementById("noteText");
const deleteNoteBtn = document.getElementById("deleteNoteBtn");
const cancelBtn = document.getElementById("cancelBtn");
const saveBtn = document.getElementById("saveBtn");

const paletteBtns = Array.from(document.querySelectorAll(".paletteBtn"));
const colorRow = document.getElementById("colorRow");

const themeBtn = document.getElementById("themeBtn");
const langBtn = document.getElementById("langBtn");
const backupBtn = document.getElementById("backupBtn");
const settingsBtn = document.getElementById("settingsBtn");

const settingsPanel = document.getElementById("settingsPanel");
const settingsSheet = document.getElementById("settingsSheet");
const settingsClose = document.querySelector(".settingsClose");

const settingsTheme = document.getElementById("settingsTheme");
const settingsAmoled = document.getElementById("settingsAmoled");
const settingsFont = document.getElementById("settingsFont");
const settingsTextSize = document.getElementById("settingsTextSize");
const settingsAccent = document.getElementById("settingsAccent");
const settingsBlur = document.getElementById("settingsBlur");

const settingsChangePin = document.getElementById("settingsChangePin");
const settingsResetPin = document.getElementById("settingsResetPin");
const settingsTimeout = document.getElementById("settingsTimeout");

const settingsArchive = document.getElementById("settingsArchive");
const settingsAnimations = document.getElementById("settingsAnimations");
const settingsHaptics = document.getElementById("settingsHaptics");

const settingsExport = document.getElementById("settingsExport");
const settingsImport = document.getElementById("settingsImport");
const settingsResetApp = document.getElementById("settingsResetApp");
const settingsInfo = document.getElementById("settings
