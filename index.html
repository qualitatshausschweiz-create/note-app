<style>
  :root {
    --bg: #f2f2f7;
    --card: #ffffff;
    --text: #000000;

    --banner-bg: rgba(0,0,0,0.85);
    --banner-text: #ffffff;
  }

  body.dark {
    --bg: #000000;
    --card: #1c1c1e;
    --text: #ffffff;

    --banner-bg: rgba(255,255,255,0.85);
    --banner-text: #000000;
  }

  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
    background: var(--bg);
    color: var(--text);
  }

  #app {
    max-width: 600px;
    margin: 0 auto;
    padding: 16px;
  }

  /* HEADER */
  header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 12px;
  }
  #appTitle {
    font-size: 24px;
    font-weight: 700;
  }
  .iconBtn {
    border: none;
    background: none;
    font-size: 22px;
    cursor: pointer;
    margin-left: 8px;
    color: var(--text);
  }

  /* BANNER */
  #bannerMsg {
    position: fixed;
    top: -60px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--banner-bg);
    color: var(--banner-text);
    padding: 10px 18px;
    border-radius: 14px;
    font-size: 15px;
    z-index: 2000;
    opacity: 0;
    transition: all 0.35s ease;
  }
  #bannerMsg.show {
    top: 20px;
    opacity: 1;
  }

  /* CATEGORIE */
  #categories {
    display: flex;
    gap: 8px;
    overflow-x: auto;
    margin-bottom: 12px;
  }
  .cat {
    flex: 0 0 auto;
    padding: 8px 12px;
    border-radius: 16px;
    background: var(--card);
    border: 1px solid #ccc;
    display: flex;
    align-items: center;
    cursor: pointer;
  }
  .catLabel {
    font-size: 14px;
  }

  /* LISTA NOTE */
  #notesList {
    display: block;
  }
  .noteItem {
    background: var(--card);
    border-radius: 14px;
    padding: 12px;
    margin-bottom: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    cursor: pointer;
  }

  /* BOTTONE + */
  #addNoteBtn {
    position: fixed;
    right: 20px;
    bottom: 30px;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    border: none;
    background: #007aff;
    color: #fff;
    font-size: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    cursor: pointer;
    z-index: 1100;
  }

  /* EDITOR */
  #noteEditor {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.35);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1400;
  }
  #noteEditorBox {
    width: 90%;
    max-width: 500px;
    background: var(--card);
    border-radius: 18px;
    padding: 16px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
    gap: 10px;
    position: relative;
  }

  /* ICONA üóë */
  #deleteNoteBtn {
    position: absolute;
    top: 12px;
    right: 12px;
    font-size: 22px;
    background: none;
    border: none;
    color: var(--text);
    cursor: pointer;
    display: none;
  }

  #noteText {
    width: 100%;
    min-height: 120px;
    border-radius: 12px;
    border: 1px solid #ccc;
    padding: 8px;
    font-size: 16px;
    resize: vertical;
    background: transparent;
    color: inherit;
  }

  #editorButtons {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
  }
  #editorButtons button {
    border-radius: 12px;
    border: none;
    padding: 8px 14px;
    font-size: 15px;
    cursor: pointer;
  }
  #cancelBtn {
    background: #ccc;
    color: #000;
  }
  #saveBtn {
    background: #007aff;
    color: #fff;
  }

  /* COLORI */
  #colorRow {
    display: flex;
    gap: 8px;
    margin-top: 4px;
  }
  .colorDot {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    border: 2px solid transparent;
    cursor: pointer;
  }
  .colorDot.selected {
    border-color: #000;
  }

  /* POPUP */
  #langPopup,
  #backupPopup {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.35);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1500;
  }
  #langBox,
  #backupBox {
    width: 80%;
    max-width: 360px;
    background: var(--card);
    border-radius: 18px;
    padding: 16px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.3);
  }

  .langChoice {
    width: 100%;
    padding: 10px;
    margin-top: 6px;
    border-radius: 12px;
    border: 1px solid #ccc;
    background: transparent;
    color: inherit;
    font-size: 16px;
    cursor: pointer;
  }

  .backupBtnRow {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 8px;
  }
  .backupAction {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px;
    border-radius: 12px;
    border: none;
    font-size: 16px;
    cursor: pointer;
    color: #000;
  }

  #autoBackupBtn { background: #007aff; color: white; }
  #manualBackupBtn { background: #ffcc00; color: black; }
  #autoRestoreBtn { background: #ff9500; color: white; }
  #manualRestoreBtn { background: #34c759; color: white; }
  #backupCloseBtn { background: #ccc; color: black; }
</style>
<body>
<div id="app">

  <div id="bannerMsg"></div>

  <header>
    <div id="appTitle">Notizen</div>
    <div>
      <button id="langBtn" class="iconBtn">üåê</button>
      <button id="backupBtn" class="iconBtn">üõü</button>
    </div>
  </header>

  <div id="categories">
    <div class="cat" data-cat="favorite"><span class="catLabel">Favoriten</span></div>
    <div class="cat" data-cat="alle"><span class="catLabel">Alle</span></div>
    <div class="cat" data-cat="arbeit"><span class="catLabel">Arbeit</span></div>
    <div class="cat" data-cat="einkauf"><span class="catLabel">Einkauf</span></div>
    <div class="cat" data-cat="zuhause"><span class="catLabel">Zuhause</span></div>
    <div class="cat" data-cat="ideen"><span class="catLabel">Ideen</span></div>
    <div class="cat" data-cat="personlich"><span class="catLabel">Pers√∂nlich</span></div>
  </div>

  <div id="notesList"></div>

  <button id="addNoteBtn">+</button>

</div>

<div id="noteEditor">
  <div id="noteEditorBox">

    <button id="deleteNoteBtn">üóë</button>

    <h2 id="editorTitle">Neue Notiz</h2>

    <textarea id="noteText"></textarea>

    <div id="colorRow">
      <div class="colorDot" data-color="#ffffff" style="background:#ffffff;"></div>
      <div class="colorDot" data-color="#ffeb3b" style="background:#ffeb3b;"></div>
      <div class="colorDot" data-color="#ff9800" style="background:#ff9800;"></div>
      <div class="colorDot" data-color="#4caf50" style="background:#4caf50;"></div>
      <div class="colorDot" data-color="#2196f3" style="background:#2196f3;"></div>
      <div class="colorDot" data-color="#e91e63" style="background:#e91e63;"></div>
    </div>

    <div id="editorButtons">
      <button id="cancelBtn">Abbrechen</button>
      <button id="saveBtn">Speichern</button>
    </div>

  </div>
</div>

<div id="langPopup">
  <div id="langBox">
    <h2>Sprache</h2>
    <button class="langChoice" data-lang="de">Deutsch</button>
    <button class="langChoice" data-lang="it">Italiano</button>
    <button class="langChoice" data-lang="en">English</button>
    <button class="langChoice" data-lang="es">Espa√±ol</button>
  </div>
</div>

<div id="backupPopup">
  <div id="backupBox">
    <h2>Sicherung</h2>

    <div class="backupBtnRow">
      <button id="autoBackupBtn" class="backupAction"><span>Backup automatisch</span></button>
      <button id="manualBackupBtn" class="backupAction"><span>Backup manuell</span></button>
      <button id="autoRestoreBtn" class="backupAction"><span>Wiederherstellung automatisch</span></button>
      <button id="manualRestoreBtn" class="backupAction"><span>Wiederherstellung manuell</span></button>
      <button id="backupCloseBtn" class="backupAction"><span>Schliessen</span></button>
    </div>

  </div>
</div>
<script>
let notes = [];
let currentNoteId = null;
let currentLang = localStorage.getItem("lang") || "de";

/* BANNER */
function showBanner(msg) {
  const b = document.getElementById("bannerMsg");
  b.textContent = msg;
  b.classList.add("show");
  setTimeout(() => b.classList.remove("show"), 1800);
}

/* BACKUP AUTO */
function autoBackup() {
  localStorage.setItem("notes_backup_auto", JSON.stringify(notes));
}

/* RIPRISTINO AUTO */
function autoRestore() {
  const saved = localStorage.getItem("notes_backup_auto");
  if (saved) {
    notes = JSON.parse(saved);
    saveNotes();
  }
}

/* STORAGE */
function saveNotes() {
  localStorage.setItem("notes", JSON.stringify(notes));
  autoBackup();
}
function loadNotes() {
  return JSON.parse(localStorage.getItem("notes") || "[]");
}

/* MOSTRA NOTE */
function showNotes(filter = "alle") {
  const list = document.getElementById("notesList");
  list.innerHTML = "";

  let filtered = notes;

  if (filter === "favorite") {
    filtered = notes.filter(n => n.favorite);
  } else if (filter !== "alle") {
    filtered = notes.filter(n => n.category === filter);
  }

  filtered.forEach(note => {
    const div = document.createElement("div");
    div.className = "noteItem";
    div.style.background = note.color;

    div.innerHTML = `
      <div>${note.text.substring(0, 80)}</div>
      <div class="favBtn" style="font-size:18px;margin-top:6px;cursor:pointer;">
        ${note.favorite ? "‚≠ê" : "‚òÜ"}
      </div>
    `;

    div.querySelector(".favBtn").onclick = (e) => {
      e.stopPropagation();
      toggleFavorite(note.id);
    };

    div.onclick = () => openEditor(note.id);

    list.appendChild(div);
  });
}

/* APRI EDITOR */
function openEditor(id = null) {
  currentNoteId = id;

  const editor = document.getElementById("noteEditor");
  const title = document.getElementById("editorTitle");
  const delBtn = document.getElementById("deleteNoteBtn");

  if (id === null) {
    title.textContent = LANG[currentLang].newNote;
    document.getElementById("noteText").value = "";
    delBtn.style.display = "none";
  } else {
    const note = notes.find(n => n.id === id);
    title.textContent = LANG[currentLang].editNote;
    document.getElementById("noteText").value = note.text;
    delBtn.style.display = "block";
  }

  editor.style.display = "flex";
}

/* SALVA */
function saveNote() {
  const text = document.getElementById("noteText").value.trim();
  if (!text) {
    closeEditor();
    return;
  }

  if (currentNoteId === null) {
    notes.push({
      id: Date.now(),
      text,
      color: "#ffffff",
      category: "alle",
      favorite: false
    });
  } else {
    const note = notes.find(n => n.id === currentNoteId);
    note.text = text;
  }

  saveNotes();
  showNotes();
  closeEditor();
}

/* ELIMINA */
function deleteNote() {
  if (!confirm("Sei sicuro?")) return;

  notes = notes.filter(n => n.id !== currentNoteId);
  saveNotes();
  showNotes();
  closeEditor();

  showBanner(LANG[currentLang].msg.deleted);
}

/* PREFERITI */
function toggleFavorite(id) {
  const note = notes.find(n => n.id === id);
  note.favorite = !note.favorite;

  saveNotes();
  showNotes();

  showBanner(note.favorite ? LANG[currentLang].msg.favAdd : LANG[currentLang].msg.favRemove);
}

/* CHIUDI */
function closeEditor() {
  document.getElementById("noteEditor").style.display = "none";
  currentNoteId = null;
}

/* EVENTI */
document.getElementById("addNoteBtn").onclick = () => openEditor();
document.getElementById("cancelBtn").onclick = closeEditor;
document.getElementById("saveBtn").onclick = saveNote;
document.getElementById("deleteNoteBtn").onclick = deleteNote;

document.querySelectorAll(".cat").forEach(btn => {
  btn.onclick = () => showNotes(btn.dataset.cat);
});

/* AVVIO */
notes = loadNotes();
autoRestore();
showNotes();
</script>
<script>
const LANG = {
  de: {
    appTitle: "Notizen",
    newNote: "Neue Notiz",
    editNote: "Notiz bearbeiten",
    cancel: "Abbrechen",
    save: "Speichern",
    chooseCategory: "Kategorie w√§hlen",
    categories: {
      favorite: "Favoriten",
      alle: "Alle",
      arbeit: "Arbeit",
      einkauf: "Einkauf",
      zuhause: "Zuhause",
      ideen: "Ideen",
      personlich: "Pers√∂nlich"
    },
    backup: {
      title: "Sicherung",
      autoBackup: "Backup automatisch",
      manualBackup: "Backup manuell",
      autoRestore: "Wiederherstellung automatisch",
      manualRestore: "Wiederherstellung manuell",
      close: "Schliessen"
    },
    msg: {
      favAdd: "Zu Favoriten hinzugef√ºgt",
      favRemove: "Aus Favoriten entfernt",
      deleted: "Notiz gel√∂scht"
    }
  },

  it: {
    appTitle: "Note",
    newNote: "Nuova nota",
    editNote: "Modifica nota",
    cancel: "Annulla",
    save: "Salva",
    chooseCategory: "Scegli categoria",
    categories: {
      favorite: "Preferiti",
      alle: "Tutte",
      arbeit: "Lavoro",
      einkauf: "Spesa",
